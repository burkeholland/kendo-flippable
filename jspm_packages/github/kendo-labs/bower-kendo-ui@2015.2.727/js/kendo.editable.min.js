/**
 * Copyright 2015 Telerik AD
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(t,define){define(["./kendo.datepicker.min","./kendo.numerictextbox.min","./kendo.validator.min","./kendo.binder.min"],t)}(function(){return function(t,e){function n(e){return e=null!=e?e:"",e.type||t.type(e)||"string"}function i(e){e.find(":input:not(:button, ["+a.attr("role")+"=upload], ["+a.attr("skip")+"], [type=file]), select").each(function(){var e=a.attr("bind"),n=this.getAttribute(e)||"",i="checkbox"===this.type||"radio"===this.type?"checked:":"value:",o=this.name;-1===n.indexOf(i)&&o&&(n+=(n.length?",":"")+i+o,t(this).attr(e,n))})}function o(t){var e,i,o=(t.model.fields||t.model)[t.field],r=n(o),s=o?o.validation:{},l=a.attr("type"),c=a.attr("bind"),h={name:t.field};for(e in s)i=s[e],p(e,_)>=0?h[l]=e:u(i)||(h[e]=f(i)?i.value||e:i),h[a.attr(e+"-msg")]=i.message;return p(r,_)>=0&&(h[l]=r),h[c]=("boolean"===r?"checked:":"value:")+t.field,h}function r(t){var e,n,i,o,r,s;if(t&&t.length)for(s=[],e=0,n=t.length;n>e;e++)i=t[e],r=i.text||i.value||i,o=null==i.value?i.text||i:i.value,s[e]={text:r,value:o};return s}function s(t,e){var n,i,o=t?t.validation||{}:{};for(n in o)i=o[n],f(i)&&i.value&&(i=i.value),u(i)&&(e[n]=i)}var a=window.kendo,l=a.ui,c=l.Widget,h=t.extend,d=a.support.browser.msie&&9>a.support.browser.version,u=a.isFunction,f=t.isPlainObject,p=t.inArray,g=/("|\%|'|\[|\]|\$|\.|\,|\:|\;|\+|\*|\&|\!|\#|\(|\)|<|>|\=|\?|\@|\^|\{|\}|\~|\/|\||`)/g,m='<div class="k-widget k-tooltip k-tooltip-validation" style="margin:0.5em"><span class="k-icon k-warning"> </span>#=message#<div class="k-callout k-callout-n"></div></div>',v="change",_=["url","email","number","date","boolean"],w={number:function(e,n){var i=o(n);t('<input type="text"/>').attr(i).appendTo(e).kendoNumericTextBox({format:n.format}),t("<span "+a.attr("for")+'="'+n.field+'" class="k-invalid-msg"/>').hide().appendTo(e)},date:function(e,n){var i=o(n),r=n.format;r&&(r=a._extractFormat(r)),i[a.attr("format")]=r,t('<input type="text"/>').attr(i).appendTo(e).kendoDatePicker({format:n.format}),t("<span "+a.attr("for")+'="'+n.field+'" class="k-invalid-msg"/>').hide().appendTo(e)},string:function(e,n){var i=o(n);t('<input type="text" class="k-input k-textbox"/>').attr(i).appendTo(e)},"boolean":function(e,n){var i=o(n);t('<input type="checkbox" />').attr(i).appendTo(e)},values:function(e,n){var i=o(n);t("<select "+a.attr("text-field")+'="text"'+a.attr("value-field")+'="value"'+a.attr("source")+"='"+a.stringify(r(n.values)).replace(/\'/g,"&apos;")+"'"+a.attr("role")+'="dropdownlist"/>').attr(i).appendTo(e),t("<span "+a.attr("for")+'="'+n.field+'" class="k-invalid-msg"/>').hide().appendTo(e)}},y=c.extend({init:function(e,n){var i=this;n.target&&(n.$angular=n.target.options.$angular),c.fn.init.call(i,e,n),i._validateProxy=t.proxy(i._validate,i),i.refresh()},events:[v],options:{name:"Editable",editors:w,clearContainer:!0,errorTemplate:m},editor:function(t,e){var i=this,o=i.options.editors,r=f(t),s=r?t.field:t,l=i.options.model||{},c=r&&t.values,d=c?"values":n(e),u=r&&t.editor,p=u?t.editor:o[d],m=i.element.find("["+a.attr("container-for")+"="+s.replace(g,"\\$1")+"]");p=p?p:o.string,u&&"string"==typeof t.editor&&(p=function(e){e.append(t.editor)}),m=m.length?m:i.element,p(m,h(!0,{},r?t:{field:s},{model:l}))},_validate:function(e){var n,i=this,o=e.value,r=i._validationEventInProgress,s={},l=a.attr("bind"),c=e.field.replace(g,"\\$1"),h=RegExp("(value|checked)\\s*:\\s*"+c+"\\s*(,|$)");s[e.field]=e.value,n=t(":input["+l+'*="'+c+'"]',i.element).filter("["+a.attr("validate")+"!='false']").filter(function(){return h.test(t(this).attr(l))}),n.length>1&&(n=n.filter(function(){var e=t(this);return!e.is(":radio")||e.val()==o}));try{i._validationEventInProgress=!0,(!i.validatable.validateInput(n)||!r&&i.trigger(v,{values:s}))&&e.preventDefault()}finally{i._validationEventInProgress=!1}},end:function(){return this.validatable.validate()},destroy:function(){var t=this;t.angular("cleanup",function(){return{elements:t.element}}),c.fn.destroy.call(t),t.options.model.unbind("set",t._validateProxy),a.unbind(t.element),t.validatable&&t.validatable.destroy(),a.destroy(t.element),t.element.removeData("kendoValidator")},refresh:function(){var n,o,r,l,c,h,u,p,g=this,m=g.options.fields||[],v=g.options.clearContainer?g.element.empty():g.element,_=g.options.model||{},w={};for(t.isArray(m)||(m=[m]),n=0,o=m.length;o>n;n++)r=m[n],l=f(r),c=l?r.field:r,h=(_.fields||_)[c],s(h,w),g.editor(r,h);if(g.options.target&&g.angular("compile",function(){return{elements:v,data:[{dataItem:_}]}}),!o){u=_.fields||_;for(c in u)s(u[c],w)}i(v),g.validatable&&g.validatable.destroy(),a.bind(v,g.options.model),g.options.model.unbind("set",g._validateProxy),g.options.model.bind("set",g._validateProxy),g.validatable=new a.ui.Validator(v,{validateOnBlur:!1,errorTemplate:g.options.errorTemplate||e,rules:w}),p=v.find(":kendoFocusable").eq(0).focus(),d&&p.focus()}});l.plugin(y)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(t,e){e()});