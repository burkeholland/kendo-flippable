/**
 * Copyright 2015 Telerik AD
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(t,define){define(["./kendo.list.min","./kendo.mobile.scroller.min"],t)}(function(){return function(t,e){function n(t,e,n){for(var i,o=0,r=e.length-1;r>o;++o)i=e[o],i in t||(t[i]={}),t=t[i];t[e[r]]=n}var i=window.kendo,o=i.ui,r=o.Select,s=i.support,a=i._activeElement,l=i.data.ObservableObject,c=i.keys,h=".kendoDropDownList",d="disabled",u="readonly",f="change",p="k-state-focused",g="k-state-default",m="k-state-disabled",v="aria-disabled",_="aria-readonly",w="mouseenter"+h+" mouseleave"+h,y="tabindex",b="filter",x="accept",k=t.proxy,C=r.extend({init:function(n,o){var s,a,l,c=this,d=o&&o.index;c.ns=h,o=t.isArray(o)?{dataSource:o}:o,r.fn.init.call(c,n,o),o=c.options,n=c.element.on("focus"+h,k(c._focusHandler,c)),c._focusInputHandler=t.proxy(c._focusInput,c),c._inputTemplate(),c._reset(),c._prev="",c._word="",c.optionLabel=t(),c._wrapper(),c._tabindex(),c.wrapper.data(y,c.wrapper.attr(y)),c._span(),c._popup(),c._mobile(),c._dataSource(),c._ignoreCase(),c._filterHeader(),c._aria(),c._enable(),c._oldIndex=c.selectedIndex=-1,d!==e&&(o.index=d),c._initialIndex=o.index,c._optionLabel(),c._initList(),c._cascade(),o.autoBind?c.dataSource.fetch():-1===c.selectedIndex&&(a=o.text||"",a||(s=o.optionLabel,s&&0===o.index?a=s:c._isSelect&&(a=n.children(":selected").text())),c._textAccessor(a)),l=t(c.element).parents("fieldset").is(":disabled"),l&&c.enable(!1),i.notify(c)},options:{name:"DropDownList",enabled:!0,autoBind:!0,index:0,text:null,value:null,delay:500,height:200,dataTextField:"",dataValueField:"",optionLabel:"",cascadeFrom:"",cascadeFromField:"",ignoreCase:!0,animation:{},filter:"none",minLength:1,virtual:!1,template:null,valueTemplate:null,optionLabelTemplate:null,groupTemplate:"#:data#",fixedGroupTemplate:"#:data#"},events:["open","close",f,"select","filtering","dataBinding","dataBound","cascade"],setOptions:function(t){r.fn.setOptions.call(this,t),this.listView.setOptions(this._listOptions(t)),this._optionLabel(),this._inputTemplate(),this._accessors(),this._filterHeader(),this._enable(),this._aria(),!this.value()&&this.optionLabel[0]&&this.select(0)},destroy:function(){var t=this;t.wrapper.off(h),t.element.off(h),t._inputWrapper.off(h),t._arrow.off(),t._arrow=null,t.optionLabel.off(),r.fn.destroy.call(t)},open:function(){var t=this;t.popup.visible()||(t.listView.isBound()&&t._state!==x?t._allowOpening()&&(t.popup.one("activate",t._focusInputHandler),t.popup.open(),t._focusItem()):(t._open=!0,t._state="rebind",t.filterInput&&(t.filterInput.val(""),t._prev=""),t._filterSource()))},_focusInput:function(){this._focusElement(this.filterInput)},_allowOpening:function(){return this.optionLabel[0]||this.filterInput||this.dataSource.view().length},toggle:function(t){this._toggle(t,!0)},current:function(t){var n;return t===e?(n=this.listView.focus(),!n&&0===this.selectedIndex&&this.optionLabel[0]?this.optionLabel:n):(this._focus(t),e)},dataItem:function(n){var i=this,o=null,r=!!i.optionLabel[0],s=i.options.optionLabel;return n===e?o=i.listView.selectedDataItems()[0]:("number"!=typeof n?n=n.hasClass("k-list-optionlabel")?-1:t(i.items()).index(n):r&&(n-=1),o=i.dataSource.flatView()[n]),!o&&r&&(o=t.isPlainObject(s)?new l(s):i._assignInstance(i._optionLabelText(),"")),o},refresh:function(){this.listView.refresh()},text:function(t){var n,i,o=this,r=o.options.ignoreCase;return t=null===t?"":t,t===e?o._textAccessor():("string"==typeof t&&(i=r?t.toLowerCase():t,o._select(function(t){return t=o._text(t),r&&(t=(t+"").toLowerCase()),t===i}),n=o.dataItem(),n&&(t=n)),o._textAccessor(t),e)},value:function(t){var n=this,i=n.dataSource;return t===e?(t=n._accessor()||n.listView.value()[0],t===e||null===t?"":t):(t&&(n._initialIndex=null),n._request&&n.options.cascadeFrom&&n.listView.isBound()?(n._valueSetter&&i.unbind(f,n._valueSetter),n._valueSetter=k(function(){n.value(t)},n),i.one(f,n._valueSetter),e):(n.listView.value(t).done(function(){-1===n.selectedIndex&&n.text()&&(n.text(""),n._accessor("",-1)),n._old=n._accessor(),n._oldIndex=n.selectedIndex}),n._fetchData(),e))},_optionLabel:function(){var n=this,o=n.options,r=o.optionLabel,s=o.optionLabelTemplate;return r?(s||(s="#:",s+="string"==typeof r?"data":i.expr(o.dataTextField,"data"),s+="#"),"function"!=typeof s&&(s=i.template(s)),n.optionLabelTemplate=s,n.optionLabel[0]||(n.optionLabel=t('<div class="k-list-optionlabel"></div>').prependTo(n.list)),n.optionLabel.html(s(r)).off().click(k(n._click,n)).on(w,n._toggleHover),n.angular("compile",function(){return{elements:n.optionLabel}}),e):(n.optionLabel.off().remove(),n.optionLabel=t(),e)},_optionLabelText:function(){var t=this.options.optionLabel;return"string"==typeof t?t:this._text(t)},_listBound:function(){var t,e,n,i=this,o=i._initialIndex,r=i.options.optionLabel,s=i._state===b,a=i.dataSource.flatView(),l=a.length;i._angularItems("compile"),i._presetValue=!1,i.options.virtual||(e=i._height(s?l||1:l),i._calculateGroupPadding(e)),i.popup.position(),i._isSelect&&(n=i.value(),l?r&&(r=i._option("",i._optionLabelText())):n&&(r=i._option(n,i.text())),i._options(a,r,n)),i._makeUnselectable(),s||(i._open&&i.toggle(i._allowOpening()),i._open=!1,i._fetch||(l?(!i.listView.value().length&&o>-1&&null!==o&&i.select(o),i._initialIndex=null,t=i.listView.selectedDataItems()[0],t&&i.text()!==i._text(t)&&i._selectValue(t)):i._textAccessor()!==i._optionLabelText()&&(i.listView.value(""),i._selectValue(null),i._oldIndex=i.selectedIndex))),i._hideBusy(),i.trigger("dataBound")},_listChange:function(){this._selectValue(this.listView.selectedDataItems()[0]),(this._presetValue||this._old&&-1===this._oldIndex)&&(this._oldIndex=this.selectedIndex)},_focusHandler:function(){this.wrapper.focus()},_focusinHandler:function(){this._inputWrapper.addClass(p),this._prevent=!1},_focusoutHandler:function(){var t=this,e=t._state===b,n=window.self!==window.top,i=t._focus();t._prevent||(clearTimeout(t._typingTimeout),e&&i&&!t.trigger("select",{item:i})&&t._select(i,!t.dataSource.view().length),s.mobileOS.ios&&n?t._change():t._blur(),t._inputWrapper.removeClass(p),t._prevent=!0,t._open=!1,t.element.blur())},_wrapperMousedown:function(){this._prevent=!!this.filterInput},_wrapperClick:function(t){t.preventDefault(),this.popup.unbind("activate",this._focusInputHandler),this._focused=this.wrapper,this._toggle()},_editable:function(t){var e=this,n=e.element,i=t.disable,o=t.readonly,r=e.wrapper.add(e.filterInput).off(h),s=e._inputWrapper.off(w);o||i?i?(r.removeAttr(y),s.addClass(m).removeClass(g)):(s.addClass(g).removeClass(m),r.on("focusin"+h,k(e._focusinHandler,e)).on("focusout"+h,k(e._focusoutHandler,e))):(n.removeAttr(d).removeAttr(u),s.addClass(g).removeClass(m).on(w,e._toggleHover),r.attr(y,r.data(y)).attr(v,!1).attr(_,!1).on("keydown"+h,k(e._keydown,e)).on("focusin"+h,k(e._focusinHandler,e)).on("focusout"+h,k(e._focusoutHandler,e)).on("mousedown"+h,k(e._wrapperMousedown,e)),e.wrapper.on("click"+h,k(e._wrapperClick,e)),e.filterInput||r.on("keypress"+h,k(e._keypress,e))),n.attr(d,i).attr(u,o),r.attr(v,i).attr(_,o)},_option:function(t,e){return'<option value="'+t+'">'+e+"</option>"},_keydown:function(t){var n,i,o=this,r=t.keyCode,s=t.altKey,l=o.popup.visible();if(o.filterInput&&(n=o.filterInput[0]===a()),r===c.LEFT?(r=c.UP,i=!0):r===c.RIGHT&&(r=c.DOWN,i=!0),!i||!n){if(t.keyCode=r,s&&r===c.UP&&o._focusElement(o.wrapper),r===c.ENTER&&o._typingTimeout&&o.filterInput&&l)return t.preventDefault(),e;i=o._move(t),i||(l&&o.filterInput||(r===c.HOME?(i=!0,o._firstItem()):r===c.END&&(i=!0,o._lastItem()),i&&(o._select(o._focus()),t.preventDefault())),s||i||!o.filterInput||o._search())}},_matchText:function(t,e){var n=this,i=n.options.ignoreCase,o=!1;return t+="",i&&(t=t.toLowerCase()),0===t.indexOf(n._word)&&(n.optionLabel[0]&&(e+=1),n._select(e),n.popup.visible()||n._change(),o=!0),o},_selectNext:function(t){for(var e,n=this,i=t,o=n.dataSource.flatView(),r=o.length;r>t;t++)if(e=n._text(o[t]),e&&n._matchText(e,t)&&(1!==n._word.length||i!==n.selectedIndex))return!0;if(i>0&&r>i)for(t=0;i>=t;t++)if(e=n._text(o[t]),e&&n._matchText(e,t))return!0;return!1},_keypress:function(t){var e,n,o,r=this;0!==t.which&&t.keyCode!==i.keys.ENTER&&(e=String.fromCharCode(t.charCode||t.keyCode),n=r.selectedIndex,o=r._word.length,r.options.ignoreCase&&(e=e.toLowerCase())," "===e&&t.preventDefault(),o||(r._word=e),r._last===e&&1>=o&&n>-1&&r._selectNext(n)||(o&&(r._word+=e),r._last=e,r._search()))},_popupOpen:function(){var t=this.popup;t.wrapper=i.wrap(t.element),t.element.closest(".km-root")[0]&&(t.wrapper.addClass("km-popup km-widget"),this.wrapper.addClass("km-widget"))},_popup:function(){r.fn._popup.call(this),this.popup.one("open",k(this._popupOpen,this))},_click:function(n){var i=n.item||t(n.currentTarget);return this.trigger("select",{item:i})?(this.close(),e):(this._userTriggered=!0,this._select(i),this._focusElement(this.wrapper),this._blur(),e)},_focusElement:function(t){var e=a(),n=this.wrapper,i=this.filterInput,o=t===i?n:i,r=s.mobileOS&&(s.touch||s.MSPointers||s.pointers);i&&i[0]===t[0]&&r||i&&o[0]===e&&(this._prevent=!0,this._focused=t.focus())},_filter:function(t){var n,i;t&&(n=this,i=n.options.ignoreCase,i&&(t=t.toLowerCase()),n._select(function(o){var r=n._text(o);return r!==e?(r+="",i&&(r=r.toLowerCase()),0===r.indexOf(t)):e}))},_search:function(){var t=this,n=t.dataSource,i=t.selectedIndex;if(clearTimeout(t._typingTimeout),"none"!==t.options.filter)t._typingTimeout=setTimeout(function(){var e=t.filterInput.val();t._prev!==e&&(t._prev=e,t.search(e)),t._typingTimeout=null},t.options.delay);else{if(t._typingTimeout=setTimeout(function(){t._word=""},t.options.delay),-1===i&&(i=0),!t.ul[0].firstChild)return n.fetch().done(function(){n.data()[0]&&i>-1&&t._selectNext(i)}),e;t._selectNext(i)}},_get:function(e){var n,i,o,r="function"==typeof e,s=r?t():t(e);if(this.optionLabel[0]&&("number"==typeof e?e>-1&&(e-=1):s.hasClass("k-list-optionlabel")&&(e=-1)),r){for(n=this.dataSource.flatView(),o=0;n.length>o;o++)if(e(n[o])){e=o,i=!0;break}i||(e=-1)}return e},_firstItem:function(){this.optionLabel[0]?this._focus(this.optionLabel):this.listView.first()},_lastItem:function(){this.optionLabel.removeClass("k-state-focused"),this.listView.last()},_nextItem:function(){this.optionLabel.hasClass("k-state-focused")?(this.optionLabel.removeClass("k-state-focused"),this.listView.first()):this.listView.next()},_prevItem:function(){this.optionLabel.hasClass("k-state-focused")||(this.listView.prev(),this.listView.focus()||this.optionLabel.addClass("k-state-focused"))},_focusItem:function(){var t=this.listView,n=t.focus(),i=t.select();i=i[i.length-1],i===e&&this.options.highlightFirst&&!n&&(i=0),i!==e?t.focus(i):this.options.optionLabel?(this._focus(this.optionLabel),this._select(this.optionLabel)):t.scrollToIndex(0)},_focus:function(t){var n=this.listView,i=this.optionLabel;return t===e?(t=n.focus(),!t&&i.hasClass("k-state-focused")&&(t=i),t):(i.removeClass("k-state-focused"),t=this._get(t),n.focus(t),-1===t&&i.addClass("k-state-focused"),e)},_select:function(t,e){var n=this;t=n._get(t),n.listView.select(t),e||n._state!==b||(n.listView.filter(!1),n._state=x),-1===t&&n._selectValue(null)},_selectValue:function(t){var n=this,i=n.options.optionLabel,o=n.optionLabel,r=n.listView.select(),s="",a="";r=r[r.length-1],r===e&&(r=-1),o.removeClass("k-state-focused k-state-selected"),t?(a=t,s=n._dataValue(t),i&&(r+=1)):i&&(n._focus(o.addClass("k-state-selected")),a=n._optionLabelText(),s="string"==typeof i?"":n._value(i),r=0),n.selectedIndex=r,null===s&&(s=""),n._textAccessor(a),n._accessor(s,r),n._triggerCascade()},_mobile:function(){var t=this,e=t.popup,n=s.mobileOS,i=e.element.parents(".km-root").eq(0);i.length&&n&&(e.options.animation.open.effects=n.android||n.meego?"fadeIn":n.ios||n.wp?"slideIn:up":e.options.animation.open.effects)},_filterHeader:function(){var e,n=this.options,i="none"!==n.filter;this.filterInput&&(this.filterInput.off(h).parent().remove(),this.filterInput=null),i&&(e='<span unselectable="on" class="k-icon k-i-search">select</span>',this.filterInput=t('<input class="k-textbox"/>').attr({role:"listbox","aria-haspopup":!0,"aria-expanded":!1}),this.list.prepend(t('<span class="k-list-filter" />').append(this.filterInput.add(e))))},_span:function(){var e,n=this,i=n.wrapper,o="span.k-input";e=i.find(o),e[0]||(i.append('<span unselectable="on" class="k-dropdown-wrap k-state-default"><span unselectable="on" class="k-input">&nbsp;</span><span unselectable="on" class="k-select"><span unselectable="on" class="k-icon k-i-arrow-s">select</span></span></span>').append(n.element),e=i.find(o)),n.span=e,n._inputWrapper=t(i[0].firstChild),n._arrow=i.find(".k-icon")},_wrapper:function(){var t,e=this,n=e.element,i=n[0];t=n.parent(),t.is("span.k-widget")||(t=n.wrap("<span />").parent(),t[0].style.cssText=i.style.cssText,t[0].title=i.title),n.hide(),e._focused=e.wrapper=t.addClass("k-widget k-dropdown k-header").addClass(i.className).css("display","").attr({unselectable:"on",role:"listbox","aria-haspopup":!0,"aria-expanded":!1})},_clearSelection:function(t){this.select(t.value()?0:-1)},_inputTemplate:function(){var e=this,n=e.options.valueTemplate;n=n?i.template(n):t.proxy(i.template("#:this._text(data)#",{useWithBlock:!1}),e),e.valueTemplate=n},_textAccessor:function(n){var i,o=null,r=this.valueTemplate,s=this.options,a=s.optionLabel,c=this.span;return n===e?c.text():(t.isPlainObject(n)||n instanceof l?o=n:a&&this._optionLabelText()===n&&(o=a,r=this.optionLabelTemplate),o||(o=this._assignInstance(n,this._accessor())),i=function(){return{elements:c.get(),data:[{dataItem:o}]}},this.angular("cleanup",i),c.html(r(o)),this.angular("compile",i),e)},_preselect:function(t,e){t||e||(e=this._optionLabelText()),this._accessor(t),this._textAccessor(e),this._old=this._accessor(),this._oldIndex=this.selectedIndex,this.listView.setValue(t),this._initialIndex=null,this._presetValue=!0},_assignInstance:function(t,e){var i=this.options.dataTextField,o={};return i?(n(o,i.split("."),t),n(o,this.options.dataValueField.split("."),e),o=new l(o)):o=t,o}});o.plugin(C)}(window.kendo.jQuery),window.kendo},"function"==typeof define&&define.amd?define:function(t,e){e()});